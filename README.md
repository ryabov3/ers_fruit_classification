# ERS Fruit Classification Model
## Проект


Создание модели сверточной нейронной сети для классификации изображений фруктов на 360 градусов.
**Скачивание модели доступно по ссылке**: https://drive.google.com/file/d/18e1nCKQCriru6WAcIZmZtc6fm9RvV8VU/view?usp=sharing
Файл представляет из себя словарь, в котором хранятся следующие ключи и их значения:
- `model_state_dict`: Состояние модели на лучше эпохе;
- `optimizer_state_dict`: Состояние оптимизатора на лучшей эпохе;
- `epoch`: Эпоха, на которой были продемонстрированы лучшие результаты обучения модели;
- `train_loss`: Значение функции потерь на тренировке, полученное на лучшей эпохе;
- `val_loss`: Значение функции потерь на валидации, полученное на лучшей эпохе;
- `accuracy`: Значение метрики точности, полученное на лучшей эпохе.

### Архитектура проекта

Для решения задачи классификации изображений фруктов была разработана глубокая сверточная сеть FruitCNN, специально адаптированная для обработки изображений размером 100×100 пикселей. Архитектура модели реализует принцип иерархического извлечения признаков:

Модель начинается с четырёх последовательных сверточных блоков, где каждый блок выполняет ключевую роль в анализе изображения. На первом этапе входные изображения (3 канала RGB) обрабатываются свёрточными слоями с небольшими ядрами 3×3, что позволяет эффективно выявлять локальные особенности — границы, текстуры, контуры фруктов. После каждой свёртки применяется пакетная нормализация (BatchNorm), которая стабилизирует распределение активаций и ускоряет сходимость обучения. Далее признаки проходят через нелинейную функцию активации ReLU, подчеркивающую наиболее значимые паттерны. Завершает каждый блок операция максимального пулинга (MaxPooling), которая уменьшает пространственное разрешение вдвое (100→50→25→12→6) — это повышает инвариантность модели к положению объекта и снижает вычислительную сложность.

Ключевой особенностью стало прогрессивное увеличение глубины признаков (32→64→128→256 каналов) по мере движения по сети. Это позволяет модели сначала фиксировать простые визуальные элементы (например, текстуру кожуры), а на последующих слоях — распознавать комплексные характеристики (форму плода, уникальные детали вроде черенков).

После извлечения пространственных признаков тензор преобразуется в одномерный вектор операцией выравнивания (Flatten). Переход к классификации реализован через двухслойный перцептрон: первый полносвязный слой (9216→1024 нейронов) с ReLU создаёт высокоуровневое представление признаков, после чего применяется регуляризация Dropout с вероятностью 50% — это предотвращает коадаптацию нейронов и снижает риск переобучения. Финальный слой проецирует признаки на пространство классов фруктов, используя линейную активацию.

Обучение проводилось с применением аугментаций (случайные повороты, отражения) для улучшения обобщающей способности. Оптимизация весов выполнялась методом Adam с контролем за плато потерь: при отсутствии улучшений точности на валидации скорость обучения снижалась в 10 раз. Архитектура показала сбалансированное соотношение ёмкости (~4.5M параметров) и эффективности, что подтвердилось итоговыми метриками.

### Метрики модели
1) **Train loss:** `0.2453`
2) **Val loss:** `0.0157`
3) **Val accuracy:** `99.48%`

### Датасет, пример изображения из датасета
- Набор данных **Fruits-360**: набор изображений, содержащих фрукты, овощи, орехи и семена.
- Ссылка на датасет: https://www.kaggle.com/datasets/moltean/fruits
- Пример изображения из датасета:

![5_100](https://github.com/user-attachments/assets/73445360-75b2-4d2a-b71e-48f3272e96f9)

### Команда проекта
1) Рябов Михаил Сергеевич
2) Ергин Игорь Константинович
3) Судоплатов Владислав Максимович
